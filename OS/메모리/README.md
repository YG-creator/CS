# 메모리 관리 전략

## Swapping

프로세스를 보조기억장치로 내보내거나 가져와서 관리



## Paging

* 논리 메모리와 물리 메모리를 연속적으로 저장 안해도됨
* 물리 메모리는 고정된 크기의 Frame 블록으로 분리
* 논리 메모리는 고정된 크기의 Page 블록으로 분리
* Page는 Frame의 남는 곳에 순서 상관없이 배치됨
* 외부단편화 해결
* 내부단편화 문제



## Segmentation

* 물리, 논리 메모리를 서로다른 크기의 블록인 Segment로 분리
* 사용자가 2개의 주소로 지정(세그먼트 번호 + 변위)
* 세그먼트 테이블에는 세그먼트의 시작 물리 주소 + 세그먼트의 길이를 저장
* 내부단편화 해결
* 외부단편화 문제



## 가상메모리

* 개념

  프로세스 전체가 메모리 내에 올라오지 않더라도 실행이 가능하도록 하는 기법

* 장점
  * 물리 메모리보다 큰 프로그램 실행 가능
  * Swapping 횟구 줄어서 실행 속도가 빨라짐
  * 더 많은 프로그램을 동시에 실행할수 있음
  * 프로세스간 페이지 공유

* 사용법

  프로세스가 요구하는 메모리 공간 -> 가상 메모리 -> 필요한 메모리만 실제 물리 메모리에 올림

* 페이지 교체

  페이지 부재시 원하는 페이지를 보조저장장치를 가져옴

  페이지 부재시 모든 물리 메모리가 사용중이면 페이지 교체

  * 방법

    물리 메모리가 모두 사용중인 상황에서의 메모리 교체 흐름이다.

    1.  디스크에서 필요한 페이지의 위치를 찾는다
    2.  빈 페이지 프레임을 찾는다.
        1.  `페이지 교체 알고리즘`을 통해 희생될(victim) 페이지를 고른다.
        2.  희생될 페이지를 디스크에 기록하고, 관련 페이지 테이블을 수정한다.
    3.  새롭게 비워진 페이지 테이블 내 프레임에 새 페이지를 읽어오고, 프레임 테이블을 수정한다.
    4.  사용자 프로세스 재시작

  * 알고리즘

    1. FIFO 페이지 교체

       먼저 물리 메모리에 들어온 페이지 순서대로 페이지 교체됨

       * 장점

         * 이해하기도 쉽고, 프로그램하기도 쉽다.

       * 단점
         * 오래된 페이지가 항상 불필요하지 않은 정보를 포함하지 않을 수 있다(초기 변수 등)
         * 처음부터 활발하게 사용되는 페이지를 교체해서 페이지 부재율을 높이는 부작용을 초래할 수 있다.
         * `Belady의 모순`: 페이지를 저장할 수 있는 페이지 프레임의 갯수를 늘려도 되려 페이지 부재가 더 많이 발생하는 모순이 존재한다.

    2. 최적 페이지 교체(Optimal Page Replacement)

       앞으로 가장 오랫동안 사용되지 않을 페이지를 찾아 교체

       * 장점

         * 알고리즘 중 가장 낮은 페이지 부재율을 보장한다.

       * 단점
         * 구현의 어려움이 있다. 모든 프로세스의 메모리 참조의 계획을 미리 파악할 방법이 없기 때문이다.

    3. LRU 페이지 교체(LRU Page Replacement)

       `LRU: Least-Recently-Used`  
       가장 오랫동안 사용되지 않은 페이지를 선택하여 교체한다.

       * 특징
         * 대체적으로 `FIFO 알고리즘`보다 우수하고, `OPT알고리즘`보다는 그렇지 못한 모습을 보인다.

    4. LFU 페이지 교체(LFU Page Replacement)

       `LFU: Least Frequently Used`  
       참조 횟수가 가장 적은 페이지를 교체하는 방법이다. 

       * 특징
         * 어떤 프로세스가 특정 페이지를 집중적으로 사용하다, 다른 기능을 사용하게되면 더 이상 사용하지 않아도 계속 메모리에 머물게 되어 초기 가정에 어긋나는 시점이 발생할 수 있다
         * 최적(OPT) 페이지 교체를 제대로 근사하지 못하기 때문에, 잘 쓰이지 않는다.

    5. MFU 페이지 교체(MFU Page Replacement)

       `MFU: Most Frequently Used`  
       참조 횟수가 가장 많은 페이지를 교체하는 방법이다. 

       * 특징
         * 최적(OPT) 페이지 교체를 제대로 근사하지 못하기 때문에, 잘 쓰이지 않는다.
